/**
* jQuery asGalleryPicker
* a jquery plugin
* Compiled: Fri Aug 19 2016 09:54:20 GMT+0800 (CST)
* @version v0.1.2
* @link https://github.com/amazingSurge/jquery-asGalleryPicker
* @copyright LGPL-3.0
*/
!function(e,t){if("function"==typeof define&&define.amd)define(["exports","jQuery"],t);else if("undefined"!=typeof exports)t(exports,require("jQuery"));else{var s={exports:{}};t(s.exports,e.jQuery),e.jqueryAsGalleryPicker=s.exports}}(this,function(e,t){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=s(t),n=function(){function e(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}}(),r={namespace:"",skin:null,lang:"en",viewportSize:"330",disabled:!1,tpl:function(){return'<div class="{{namespace}}"><div class="{{namespace}}-initial"><i></i>{{strings.placeholder}}</div><div class="{{namespace}}-info"><img class="{{namespace}}-info-image" src=""><span class="{{namespace}}-info-count">{{strings.count}}</span><div class="{{namespace}}-info-add">{{strings.add}}</div><div class="{{namespace}}-info-expand">{{strings.expand}}</div></div><div class="{{namespace}}-expand"><a class="{{namespace}}-expand-close" href="#"></a><div class="{{namespace}}-expand-add"><i></i>{{strings.add}}</div><ul class="{{namespace}}-expand-items"></ul></div></div>'},process:function(e){return e?e.join(","):""},parse:function(e){if("string"==typeof e&&0!==e.length){var t=[];return t=e.split(",")}return null},getImage:function(e){return e},change:function(e){return e},add:function(){},onChange:function(){}},d="asGalleryPicker";r.namespace=d;var l=function(){function e(t,s){i(this,e);var n={};this.element=t,this.$element=(0,a.default)(t),this.options=a.default.extend({},r,s,this.$element.data(),n),"undefined"==typeof e.Strings[this.options.lang]?this.lang="en":this.lang=this.options.lang,this.strings=a.default.extend({},e.Strings[this.lang],this.options.strings),this.namespace=this.options.namespace,this.components=a.default.extend(!0,{},this.components),this.classes={skin:this.namespace+"_"+this.options.skin,disabled:this.namespace+"_disabled",active:this.namespace+"_active",empty:this.namespace+"_empty",exist:this.namespace+"_exist",expand:this.namespace+"_expand",hover:this.namespace+"_hover"},this.$element.addClass(this.namespace+"-input"),this.disabled=!1,this.initialed=!1;var l=this;a.default.extend(l,{init:function(){this._createHtml(),this.$expand.height(this.options.viewportSize),this.options.disabled&&this.disable(),this.options.skin&&this.$wrap.addClass(this.classes.skin);var e=this.options.parse(this.$element.val());this.set(e,!1),this.$wrap.addClass(this.classes.exist),this._bindEvent(),this.initialed=!0,this._trigger("ready")},_bindEvent:function(){this.$initial.on("click",function(){if(!l.disabled)return l.options.add.call(l),!1}),this.$infoAdd.on("click",function(){if(!l.disabled)return l.options.add.call(l),!1}),this.$infoExpand.on("click",function(){l.disabled||(l.$wrap.addClass(l.classes.expand).removeClass(l.classes.exist),l._updateScrollbar())}),this.$info.on("mouseenter",function(){l.disabled||l.$info.addClass(l.classes.hover)}).on("mouseleave",function(){l.disabled||l.$info.removeClass(l.classes.hover)}),this.$expand.on("click","."+this.namespace+"-expand-close",function(){if(!l.disabled)return l.$wrap.removeClass(l.classes.expand).addClass(l.classes.exist),!1}),this.$expand.on("click","."+this.namespace+"-expand-add",function(){if(!l.disabled)return l.options.add.call(l),!1}),this.$expand.on("click","."+this.namespace+"-item-remove",a.default.proxy(function(e){if(!this.disabled)return this.remove((0,a.default)(e.currentTarget).parent().index()),this._updateScrollbar(),!1},this)),this.$expand.on("mouseenter","."+this.namespace+"-item",a.default.proxy(function(e){this.disabled||(0,a.default)(e.currentTarget).addClass(this.classes.hover)},this)).on("mouseleave","."+this.namespace+"-item",a.default.proxy(function(e){this.disabled||(0,a.default)(e.currentTarget).removeClass(this.classes.hover)},this)),this.$expand.on("click","."+this.namespace+"-item-change",a.default.proxy(function(e){if(!this.disabled)return this.options.change.call(l,(0,a.default)(e.currentTarget).parent().index()),!1},this))},_createHtml:function(){this.$wrap=(0,a.default)(this.options.tpl().replace(/\{\{namespace\}\}/g,this.namespace).replace(/\{\{strings.placeholder\}\}/g,this.strings.placeholder).replace(/\{\{strings.add\}\}/g,this.strings.add).replace(/\{\{strings.count\}\}/g,this.strings.count).replace(/\{\{strings.expand\}\}/g,this.strings.expand)),this.$element.after(this.$wrap),this.$initial=(0,a.default)("."+this.namespace+"-initial",this.$wrap),this.$info=(0,a.default)("."+this.namespace+"-info",this.$wrap),this.$expand=(0,a.default)("."+this.namespace+"-expand",this.$wrap),this.$infoCount=(0,a.default)("."+this.namespace+"-info-count",this.$wrap),this.$infoExpand=(0,a.default)("."+this.namespace+"-info-expand",this.$wrap),this.$infoAdd=(0,a.default)("."+this.namespace+"-info-add",this.$wrap),this.$infoImage=(0,a.default)("."+this.namespace+"-info-image",this.$wrap),this.$expandItems=(0,a.default)("."+this.namespace+"-expand-items",this.$expand)},_trigger:function(e){for(var t=arguments.length,s=Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];var a=[this].concat(s);this.$element.trigger("asGalleryPicker::"+e,a),e=e.replace(/\b\w+\b/g,function(e){return e.substring(0,1).toUpperCase()+e.substring(1)});var n="on"+e;if("function"==typeof l.options[n]){var r;(r=l.options)[n].apply(r,s)}},_update:function(){this.$element.val(this.val()),this._trigger("change",this.value,this.options.name,d)},_setState:function(){(0,a.default)(this.$infoCount).text(this.count),this.count>0?(this.$infoImage.attr("src",this._getImageByIndex(this.count-1)),this.$wrap.removeClass(this.classes.empty)):(this.$infoImage.attr("src",""),this.$wrap.addClass(this.classes.empty))},_getImageByIndex:function(e){if(e<this.value.length){var t=this.value[e];return this.options.getImage(t)}return null},_updateList:function(){var e=this.$expand.find("."+this.namespace+"-expand-items").children().length;if(this.count>e)for(var t=e;t<this.count;t++)this._addImage(this.value[t]).appendTo(this.$expand.find("."+this.namespace+"-expand-items"));else if(this.count===e&&this.count>0){var s=this.value[this.editIndex];this.$expand.find("."+this.namespace+"-expand-items").children().eq(this.editIndex).html(this._addImage(s))}else this._delImage();this._updateScrollbar()},_addImage:function(e){return(0,a.default)("<li/>",{html:'<img src="'+this.options.getImage(e)+'"/><div class="'+this.namespace+'-item-change">'+this.strings.change+'</div><a class="'+this.namespace+'-item-remove" href=""></a>',class:this.namespace+"-item"})},_delImage:function(){this.$expand.find("."+this.namespace+"-expand-items").children().eq(this.indexed).remove()},_updateScrollbar:function(){var e=this;"undefined"!=typeof this.$expand.data("asScrollbar")&&this.$expand.asScrollbar("destory"),this.$expand.asScrollbar({namespace:e.namespace+"-expand"})},_clearImages:function(){this.$expand.find("."+this.namespace+"-item").remove()}}),this._trigger("init"),this.init()}return n(e,[{key:"val",value:function(e){if("undefined"==typeof e)return this.options.process(this.value);var t=this.options.parse(e);t?this.set(t):this.clear()}},{key:"set",value:function(e,t){a.default.isArray(e)?this.value=e:this.value=[],this._clearImages(),this.count=this.value.length,this._setState(),this._updateList(),t!==!1&&this._update()}},{key:"add",value:function(e,t){for(var s in e)({}).hasOwnProperty.call(e,s)&&this.value.push(e[s]);this.count=this.value.length,this._setState(),this._updateList(),t!==!1&&this._update()}},{key:"change",value:function(e,t,s){this.value[e]=t,this.$expand.find("."+this.namespace+"-expand-items").children().eq(e).find("img").attr("src",this.options.getImage(t)),this._setState(),s!==!1&&this._update()}},{key:"remove",value:function(e,t){this.value.splice(e,1),this.count-=1,this.$expand.find("."+this.namespace+"-expand-items").children().eq(e).remove(),this._setState(),t!==!1&&this._update()}},{key:"clear",value:function(e){this._clearImages(),this.count=0,this.value=[],this._setState(),e!==!1&&this._update()}},{key:"get",value:function(){return this.value}},{key:"enable",value:function(){this.disabled=!1,this.$wrap.removeClass(this.classes.disabled)}},{key:"disable",value:function(){this.disabled=!0,this.$wrap.addClass(this.classes.disabled)}},{key:"destory",value:function(){this.$element.data(d,null),this.$wrap.remove(),this._trigger("destory")}}],[{key:"_jQueryInterface",value:function(t){for(var s=arguments.length,i=Array(s>1?s-1:0),n=1;n<s;n++)i[n-1]=arguments[n];if("string"!=typeof t)return this.each(function(){a.default.data(this,d)||a.default.data(this,d,new e(this,t))});if(/^\_/.test(t))return!1;if(!(/^(get)$/.test(t)||"val"===t&&0===i.length))return this.each(function(){var e=a.default.data(this,d);e&&"function"==typeof e[t]&&e[t].apply(e,i)});var r=this.first().data(d);return r&&"function"==typeof r[t]?r[t].apply(r,i):void 0}}]),e}();l.defaults={},l.Strings={},l.localize=function(e,t){l.Strings[e]=t},l.localize("en",{placeholder:"Click to upload",count:"zero",add:"Add image",expand:"expand",change:"change"}),a.default.fn[d]=l._jQueryInterface,a.default.fn[d].constructor=l,a.default.fn[d].noConflict=function(){return a.default.fn[d]=window.JQUERY_NO_CONFLICT,l._jQueryInterface},e.default=l});