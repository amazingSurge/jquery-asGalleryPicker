/**
* jQuery asGalleryPicker v0.2.2
* https://github.com/amazingSurge/jquery-asGalleryPicker
*
* Copyright (c) amazingSurge
* Released under the LGPL-3.0 license
*/
!function(e,t){if("function"==typeof define&&define.amd)define(["jquery"],t);else if("undefined"!=typeof exports)t(require("jquery"));else{var s={exports:{}};t(e.jQuery),e.jqueryAsGalleryPickerEs=s.exports}}(this,function(e){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=t(e),a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function e(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}}(),l={namespace:"asGalleryPicker",skin:null,lang:"en",viewportSize:"330",disabled:!1,tpl:function(){return'<div class="{{namespace}}"><div class="{{namespace}}-initial"><i></i>{{strings.placeholder}}</div><div class="{{namespace}}-info"><img class="{{namespace}}-info-image" src=""><span class="{{namespace}}-info-count">{{strings.count}}</span><div class="{{namespace}}-info-add">{{strings.add}}</div><div class="{{namespace}}-info-expand">{{strings.expand}}</div></div><div class="{{namespace}}-expand"><a class="{{namespace}}-expand-close" href="#"></a><div class="{{namespace}}-expand-add"><i></i>{{strings.add}}</div><ul class="{{namespace}}-expand-items"></ul></div></div>'},process:function(e){return e?e.join(","):""},parse:function(e){if("string"==typeof e&&0!==e.length){var t=[];return t=e.split(",")}return null},getImage:function(e){return e},change:function(e){return e},add:function(){},onChange:function(){}},r="asGalleryPicker",d={},o=function(){function e(t,a){s(this,e);var n={};this.element=t,this.$element=(0,i.default)(t),this.options=i.default.extend({},l,a,this.$element.data(),n),"undefined"==typeof d[this.options.lang]?this.lang="en":this.lang=this.options.lang,this.strings=i.default.extend({},d[this.lang],this.options.strings),this.namespace=this.options.namespace,this.components=i.default.extend(!0,{},this.components),this.classes={skin:this.namespace+"_"+this.options.skin,disabled:this.namespace+"_disabled",active:this.namespace+"_active",empty:this.namespace+"_empty",exist:this.namespace+"_exist",expand:this.namespace+"_expand",hover:this.namespace+"_hover"},this.$element.addClass(this.namespace+"-input"),this.disabled=!1,this.initialed=!1,this._trigger("init"),this.init()}return n(e,[{key:"init",value:function(){this._createHtml(),this.$expand.height(this.options.viewportSize),this.options.disabled&&this.disable(),this.options.skin&&this.$wrap.addClass(this.classes.skin);var e=this.options.parse(this.$element.val());this.set(e,!1),this.$wrap.addClass(this.classes.exist),this._bindEvent(),this.initialed=!0,this._trigger("ready")}},{key:"_bindEvent",value:function(){var e=this;this.$initial.on("click",function(){if(!e.disabled)return e.options.add.call(e),!1}),this.$infoAdd.on("click",function(){if(!e.disabled)return e.options.add.call(e),!1}),this.$infoExpand.on("click",function(){e.disabled||(e.$wrap.addClass(e.classes.expand).removeClass(e.classes.exist),e._updateScrollbar())}),this.$info.on("mouseenter",function(){e.disabled||e.$info.addClass(e.classes.hover)}).on("mouseleave",function(){e.disabled||e.$info.removeClass(e.classes.hover)}),this.$expand.on("click","."+this.namespace+"-expand-close",function(){if(!e.disabled)return e.$wrap.removeClass(e.classes.expand).addClass(e.classes.exist),!1}),this.$expand.on("click","."+this.namespace+"-expand-add",function(){if(!e.disabled)return e.options.add.call(e),!1}),this.$expand.on("click","."+this.namespace+"-item-remove",i.default.proxy(function(e){if(!this.disabled)return this.remove((0,i.default)(e.currentTarget).parent().index()),this._updateScrollbar(),!1},this)),this.$expand.on("mouseenter","."+this.namespace+"-item",i.default.proxy(function(e){this.disabled||(0,i.default)(e.currentTarget).addClass(this.classes.hover)},this)).on("mouseleave","."+this.namespace+"-item",i.default.proxy(function(e){this.disabled||(0,i.default)(e.currentTarget).removeClass(this.classes.hover)},this)),this.$expand.on("click","."+this.namespace+"-item-change",i.default.proxy(function(t){if(!this.disabled)return this.options.change.call(e,(0,i.default)(t.currentTarget).parent().index()),!1},this))}},{key:"_createHtml",value:function(){this.$wrap=(0,i.default)(this.options.tpl().replace(/\{\{namespace\}\}/g,this.namespace).replace(/\{\{strings.placeholder\}\}/g,this.strings.placeholder).replace(/\{\{strings.add\}\}/g,this.strings.add).replace(/\{\{strings.count\}\}/g,this.strings.count).replace(/\{\{strings.expand\}\}/g,this.strings.expand)),this.$element.after(this.$wrap),this.$initial=(0,i.default)("."+this.namespace+"-initial",this.$wrap),this.$info=(0,i.default)("."+this.namespace+"-info",this.$wrap),this.$expand=(0,i.default)("."+this.namespace+"-expand",this.$wrap),this.$infoCount=(0,i.default)("."+this.namespace+"-info-count",this.$wrap),this.$infoExpand=(0,i.default)("."+this.namespace+"-info-expand",this.$wrap),this.$infoAdd=(0,i.default)("."+this.namespace+"-info-add",this.$wrap),this.$infoImage=(0,i.default)("."+this.namespace+"-info-image",this.$wrap),this.$expandItems=(0,i.default)("."+this.namespace+"-expand-items",this.$expand)}},{key:"_trigger",value:function(e){for(var t=arguments.length,s=Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];var a=[this].concat(s);this.$element.trigger(r+"::"+e,a),e=e.replace(/\b\w+\b/g,function(e){return e.substring(0,1).toUpperCase()+e.substring(1)});var n="on"+e;"function"==typeof this.options[n]&&this.options[n].apply(this,s)}},{key:"_update",value:function(){this.$element.val(this.val()),this._trigger("change",this.value)}},{key:"_setState",value:function(){(0,i.default)(this.$infoCount).text(this.count),this.count>0?(this.$infoImage.attr("src",this._getImageByIndex(this.count-1)),this.$wrap.removeClass(this.classes.empty)):(this.$infoImage.attr("src",""),this.$wrap.addClass(this.classes.empty))}},{key:"_getImageByIndex",value:function(e){if(e<this.value.length){var t=this.value[e];return this.options.getImage(t)}return null}},{key:"_updateList",value:function(){var e=this.$expand.find("."+this.namespace+"-expand-items").children().length;if(this.count>e)for(var t=e;t<this.count;t++)this._addImage(this.value[t]).appendTo(this.$expand.find("."+this.namespace+"-expand-items"));else if(this.count===e&&this.count>0){var s=this.value[this.editIndex];this.$expand.find("."+this.namespace+"-expand-items").children().eq(this.editIndex).html(this._addImage(s))}else this._delImage();this._updateScrollbar()}},{key:"_addImage",value:function(e){return(0,i.default)("<li/>",{html:'<img src="'+this.options.getImage(e)+'"/><div class="'+this.namespace+'-item-change">'+this.strings.change+'</div><a class="'+this.namespace+'-item-remove" href=""></a>',class:this.namespace+"-item"})}},{key:"_delImage",value:function(){this.$expand.find("."+this.namespace+"-expand-items").children().eq(this.indexed).remove()}},{key:"_updateScrollbar",value:function(){"undefined"!=typeof this.$expand.data("asScrollbar")&&this.$expand.asScrollbar("destroy"),this.$expand.asScrollbar({namespace:this.namespace+"-expand"})}},{key:"_clearImages",value:function(){this.$expand.find("."+this.namespace+"-item").remove()}},{key:"val",value:function(e){if("undefined"==typeof e)return this.options.process(this.value);var t=this.options.parse(e);t?this.set(t):this.clear()}},{key:"set",value:function(e,t){i.default.isArray(e)?this.value=e:this.value=[],this._clearImages(),this.count=this.value.length,this._setState(),this._updateList(),t!==!1&&this._update()}},{key:"add",value:function(e,t){for(var s in e)({}).hasOwnProperty.call(e,s)&&this.value.push(e[s]);this.count=this.value.length,this._setState(),this._updateList(),t!==!1&&this._update()}},{key:"change",value:function(e,t,s){this.value[e]=t,this.$expand.find("."+this.namespace+"-expand-items").children().eq(e).find("img").attr("src",this.options.getImage(t)),this._setState(),s!==!1&&this._update()}},{key:"remove",value:function(e,t){this.value.splice(e,1),this.count-=1,this.$expand.find("."+this.namespace+"-expand-items").children().eq(e).remove(),this._setState(),t!==!1&&this._update()}},{key:"clear",value:function(e){this._clearImages(),this.count=0,this.value=[],this._setState(),e!==!1&&this._update()}},{key:"get",value:function(){return this.value}},{key:"enable",value:function(){this.disabled=!1,this.$wrap.removeClass(this.classes.disabled)}},{key:"disable",value:function(){this.disabled=!0,this.$wrap.addClass(this.classes.disabled)}},{key:"destroy",value:function(){this.$element.data(r,null),this.$wrap.remove(),this._trigger("destroy")}}],[{key:"setDefaults",value:function(e){i.default.extend(l,i.default.isPlainObject(e)&&e)}},{key:"localize",value:function(e,t){d[e]=t}}]),e}();o.localize("en",{placeholder:"Click to upload",count:"zero",add:"Add image",expand:"expand",change:"change"});var c={version:"0.2.2"},h="asGalleryPicker",u=i.default.fn.asGalleryPicker,p=function(e){for(var t=this,s=arguments.length,n=Array(s>1?s-1:0),l=1;l<s;l++)n[l-1]=arguments[l];if("string"==typeof e){var r=function(){var s=e;if(/^_/.test(s))return{v:!1};if(!(/^(get)$/.test(s)||"val"===s&&0===n.length))return{v:t.each(function(){var e=i.default.data(this,h);e&&"function"==typeof e[s]&&e[s].apply(e,n)})};var a=t.first().data(h);return a&&"function"==typeof a[s]?{v:a[s].apply(a,n)}:void 0}();if("object"===("undefined"==typeof r?"undefined":a(r)))return r.v}return this.each(function(){(0,i.default)(this).data(h)||(0,i.default)(this).data(h,new o(this,e))})};i.default.fn.asGalleryPicker=p,i.default.asGalleryPicker=i.default.extend({setDefaults:o.setDefaults,noConflict:function(){return i.default.fn.asGalleryPicker=u,p}},c)});